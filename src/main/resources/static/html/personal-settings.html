<!DOCTYPE html>
<html lang="en" xmlns:width="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>个人设置</title>
    <link rel="stylesheet" href="../css/settings.css">
    <link rel="stylesheet" href="../css/settings.scss">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../css/search-style.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
</head>
<body>

<script src="https://cdn.pipilong.com.cn/js/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://cdn.pipilong.com.cn/js/axios-0.18.0.js"></script>

<div id="app">

    <el-container>
        <el-header style="background-color: #ffffff;margin-top: -8px;">
            <!--            <div class="hr-double"></div>-->
            <el-row class="row">
                <el-col :span="1">
                    <div></div>
                </el-col>
                <el-col :span="2">
                    <div>
                        <a href="../index.html">
                            <img src="https://cdn.pipilong.com.cn/logo.png" class="logo" alt=""/>
                        </a>
                    </div>
                </el-col>
                <el-col :span="2">
                    <div>
                        <a href="../index.html" class="home-page-style1 head_icon">
                            <div style="float: left;margin-top: 21px;padding-left: 54px;"><img src="https://cdn.pipilong.com.cn/svg/home.svg" width="19px;"></div>
                            <div style="float: right;margin-top: -38px;padding-right: 6px;">首页</div></a>
                    </div>
                </el-col>
                <el-col :span="2">
                    <div>
                        <a href="./interview-experience.html" class="home-page-style1 head_icon">
                            <div style="float: left;margin-top: 21px;padding-left: 50px;"><img src="https://cdn.pipilong.com.cn/svg/book.svg" width="19px;"></div>
                            <div style="float: right;margin-top: -38px;padding-right: 10px;">面经</div></a>
                    </div>
                </el-col>
                <el-col :span="8">
                    <div>
                        <el-input v-model="search" placeholder="Enter Your Search Content" class="txtb">
                            <template #suffix>
                                <el-button icon="el-icon-search" circle></el-button>
                            </template>
                        </el-input>
                    </div>
                </el-col>
                <el-col :span="2">

                    <div>
                        <a href="./java.html" class="home-page-style1 head_icon">
                            <div style="float: left;margin-top: 19px;padding-left: 10px;"><img src="https://cdn.pipilong.com.cn/svg/java.svg" width="19px;"></div>
                            <div style="float: right;margin-top: -38px;padding-right: 34px;">八股文</div></a>
                    </div>
                </el-col>
                <el-col :span="2">

                    <div>
                        <a href="./message.html" class="home-page-style1 head_icon">
                            <div style="float: left;margin-top: 20px;padding-left: 20px;"><img src="https://cdn.pipilong.com.cn/svg/message.svg" width="19px;"></div>
                            <div style="float: right;margin-top: -38px;padding-right: 40px;">消息</div></a>
                    </div>

                </el-col>
                <el-col :span="2">
                    <div>
                        <el-dropdown :hide-on-click="false" show-timeout="0" hide-timeout="100">
                            <span class="el-dropdown-link">
                                网站相关
                                <i class="el-icon-arrow-down el-icon--right"></i>
                            </span>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item>
                                    <i class="el-icon-s-custom"></i>
                                    <a href="https://cos.pipilong.com.cn/作者介绍.html" class="home-page-style5" target="_blank">作者介绍</a>
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <i class="ri-booklet-fill"></i>
                                    网站日志
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <i><img src="https://cdn.pipilong.com.cn/svg/github.svg" width="15px;" alt=""/></i>
                                    <a href="https://github.com/pipilongstar/PipilongPersonalBlog" target="_blank"
                                       class="home-page-style5">项目源码</a>
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <i><img src="https://cdn.pipilong.com.cn/svg/gitee.svg" width="14px;" alt=""/></i>
                                    <a href="https://gitee.com/pipilongstar/PipilongPersonalBlog" target="_blank"
                                       class="home-page-style5">项目源码</a>
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                </el-col>

                <el-col :span="3">
                    <div v-if="!isLogin">
                        <a href="./login.html" target="_blank">
                            <el-button round type="primary" class="login_button--primary">登录/注册</el-button>
                        </a>
                    </div>
                    <div v-if="isLogin">

                        <div style="margin-top: 13px;">
                            <a href="./personal-center.html" target="_blank" @mouseover="avatarShow"
                               @mouseleave="avatarShut">
                                <el-avatar shape="circle" :size="40" :fit="fit" :src="avatarUrl"
                                           class="avatar-style"></el-avatar>
                            </a>
                        </div>

                        <!--                        鼠标悬停头像小卡片-->
                        <el-collapse-transition>
                            <div v-show="isAvatarShow" class="isAvatarShow_style" @mouseover="avatarShow"
                                 @mouseleave="avatarShut">
                                <el-card shadow="always" style="height: 220px;width: 190px;border-radius: 16px;">
                                    <a href="./personal-center.html" target="_blank">
                                        <div style="margin-top: -5px;">
                                            <el-avatar :src="avatarUrl"
                                                       :size="60"></el-avatar>
                                        </div>
                                    </a>
                                    <div style="margin-top: -50px;">
                                        <span v-if="user.username.length===0" style="color: #dc6a6a"><h3>还没有名称哦！</h3></span>
                                        <span v-if="user.username.length<=7&&user.username.length>0">
                                            <h3>{{user.username}}</h3>
                                        </span>
                                        <span v-if="user.username.length>7">
                                            <h3>{{user.username.substring(0,7)}}...</h3>
                                        </span>
                                    </div>

                                    <div style="margin-top: -28px;margin-left: -26px;">
                                        <el-button type="primary" plain class="avatar_card_item--primary" @click="openPersonalSettings">
                                            <div style="font-size: 18px;float: left;margin-left: 14px;">
                                                <i class="ri-user-settings-line"></i>
                                            </div>
                                            <div style="float: right;margin-right: 48px;font-size: 15px;margin-top: 4px;">
                                                个人设置
                                            </div>
                                        </el-button>
                                    </div>

                                    <div style="margin-left: -26px;margin-top: -6px;">
                                        <el-button type="primary" plain class="avatar_card_item--primary" @click="logout">
                                            <div style="font-size: 18px;float: left;margin-left: 14px;">
                                                <i class="ri-arrow-left-circle-line"></i>
                                            </div>
                                            <div style="float: right;margin-right: 48px;font-size: 15px;margin-top: 4px;">
                                                退出登录
                                            </div>
                                        </el-button>
                                    </div>

                                </el-card>
                            </div>
                        </el-collapse-transition>

                    </div>
                </el-col>
            </el-row>

        </el-header>
        <!--        中部-->
        <el-container>
            <!--            左侧-->
            <el-aside width="300px" style="background-color: #f5f5f5">

                <div style="margin-top: 110px;">
                    <img src="https://cdn.pipilong.com.cn/svg/setting1.svg" style="width: 220px;"/>
                </div>

            </el-aside>
            <el-container>
                <!--                主-->
                <el-main style="background-color: #f5f5f5">

                    <el-card shadow="always">

                        <div style="margin-top: -70px;margin-left: -620px;">
                            <h3>个人资料</h3>
                        </div>

                        <div style="margin-top: -53px;">

                            <el-upload
                                    action="https://www.pipilong.com.cn/upload/avatar"
                                    :multiple="true"
                                    :with-credentials="true"
                                    :show-file-list="false"
                                    :http-request="upload"
                                    :on-success="handleAvatarSuccess"
                                    :before-upload="beforeAvatarUpload">

                                <el-avatar :src=imageUrl :size="100"></el-avatar>
                                <!--                                <i v-else class="el-icon-plus avatar-uploader-icon"></i>-->
                            </el-upload>

                        </div>

                        <!--                        个人资料框-->
                        <div>

                            <el-row style="margin-top: -50px;line-height: 2;">
                                <el-col :span="12">
                                    <div>
                                        <div style="font-size: 17px;color: #656565;">
                                            昵称
                                        </div>

                                        <div style="width: 220px;margin-left: 70px;">
                                            <el-input v-model="user.username" class="username_input_style"></el-input>
                                        </div>

                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div>
                                        <div style="font-size: 17px;color: #656565;">
                                            性别
                                        </div>

                                        <div>
                                            <el-radio-group v-model="user.gender" style="border-radius: 10px;">
                                                <div style="margin-left: -100px;">
                                                    <el-radio-button label="男"
                                                                     class="radio_button_style"></el-radio-button>
                                                </div>
                                                <div style="margin-top: -39px;margin-right: -100px;">
                                                    <el-radio-button label="女"></el-radio-button>
                                                </div>
                                            </el-radio-group>
                                        </div>
                                    </div>
                                </el-col>
                            </el-row>

                            <div style="height: 10px;"></div>

                            <el-row style="line-height: 2">
                                <el-col :span="12">
                                    <div>
                                        <div style="font-size: 17px;color: #656565;">
                                            生日
                                        </div>
                                        <div style="">
                                            <el-date-picker
                                                    v-model="user.birthday"
                                                    type="date"
                                                    placeholder="选择日期"
                                                    value-format="yyyy-MM-dd">
                                            </el-date-picker>
                                        </div>

                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div>
                                        <div style="font-size: 17px;color: #656565;">
                                            现居地
                                        </div>

                                        <div style="">
                                            <el-select v-model="user.address" placeholder="请选择现居地">
                                                <el-option
                                                        v-for="item in address_options"
                                                        :key="item.value"
                                                        :label="item.label"
                                                        :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                    </div>
                                </el-col>
                            </el-row>

                            <div style="height: 10px;"></div>

                            <el-row style="line-height: 2">
                                <el-col :span="24">
                                    <div>

                                        <div style="font-size: 17px;color: #656565;">
                                            个人寄语
                                        </div>

                                        <div style="width: 400px;margin-left: 172px;">
                                            <el-input
                                                    type="textarea"
                                                    :autosize="{ minRows: 2, maxRows: 4}"
                                                    placeholder="送给自己的一段话..."
                                                    v-model="user.person_message"
                                                    maxlength="100"
                                                    show-word-limit>
                                            </el-input>
                                        </div>

                                    </div>
                                </el-col>
                            </el-row>

                            <div style="height: 10px;"></div>

                            <el-row style="line-height: 2">
                                <el-col :span="24">
                                    <div>

                                        <div style="font-size: 17px;color: #656565;">
                                            GitHub
                                        </div>

                                        <div style="width: 400px;margin-left: 172px;">
                                            <el-input placeholder="github地址" v-model="user.github_url">
                                                <template slot="prepend">https//:github.com/</template>
                                            </el-input>
                                        </div>

                                    </div>
                                </el-col>
                            </el-row>

                            <div style="height: 10px;"></div>

                            <el-row style="line-height: 2">
                                <el-col :span="24">
                                    <div>

                                        <div style="font-size: 17px;color: #656565;">
                                            就读学校
                                        </div>

                                        <div style="width: 400px;margin-left: 172px;height: 100px;">
                                            <el-input v-model="user.school" placeholder="最高学历学府">
                                                <template #prefix>
                                                    <span style="font-size: 20px;">
                                                        <i class="ri-pencil-ruler-line"></i>
                                                    </span>
                                                </template>
                                            </el-input>
                                        </div>

                                    </div>
                                </el-col>
                            </el-row>

                            <el-row>
                                <el-col style="margin-top: -70px;">
                                    <el-button type="primary" plain class="save_style--primary" @click="save">保存
                                    </el-button>
                                </el-col>
                            </el-row>

                        </div>
                        <div style="background-color: #eceaea;height: 2px;margin-top: -20px;"></div>
                        <el-row>
                            <el-col style="margin-left: -300px;margin-top: -50px;">
                                <h3>账户安全</h3>
                            </el-col>
                        </el-row>

                        <!--                        账户安全框-->
                        <div>

                            <el-row>
                                <el-col :span="6" style="margin-top: -100px;margin-left: -10px;color: #333333;">
                                    <span style="font-size: 20px;"><i class="ri-smartphone-line"></i></span>
                                    <span>手机号</span>
                                </el-col>
                                <el-col :span="6"
                                        style="margin-top: -100px;color: #333333;margin-left: -6px;height: 200px;">
                                    <div style="width: 210px;">
                                        <el-input
                                                :placeholder="telephone"
                                                v-model="telephone"
                                                :disabled="true">
                                            <template slot="prepend">+86</template>
                                        </el-input>
                                    </div>
                                </el-col>
                                <el-col :span="12" style="margin-top: -100px;">
                                    <div style="margin-left: 158px;">
                                        <span style="font-size: 18px;color: #949393;"><i class="ri-quill-pen-fill"></i></span>
                                        <el-button type="text" class="update_button--text" @click="updateTelephone">
                                            修改
                                        </el-button>
                                    </div>
                                </el-col>
                            </el-row>

<!--                            更新手机对话框-->
                            <div>
                                <el-dialog
                                        :visible.sync="dialogUpdateTelephone"
                                        width="30%"
                                        :before-close="handleClose"
                                        :show-close="false"
                                        class="dialog_style">
                                    <span>
                                        <el-steps :active="active1" finish-status="success" align-center style="line-height: 1;width: 400px;margin-top: -30px;">
                                            <el-step title="验证当前手机号"></el-step>
                                            <el-step title="更改为新手机号"></el-step>
                                            <el-step title="更改完成"></el-step>
                                        </el-steps>
                                    </span>
                                    <div v-show="active1==0" style="margin-top: 26px;">
<!--                                        验证当前手机号-->
                                        <el-input
                                                :placeholde="telephone"
                                                v-model="telephone"
                                                :disabled="true"
                                                style="width: 250px;">
                                        </el-input><br>
                                        <el-input v-model="code" placeholder="请输入验证码" @blur="verificationCode" style="width: 250px;margin-top: 10px;">
                                            <template #suffix>
                                                <el-button id="sendCodeId" type="text" class="sendSms_button--text" @click="sendSms"
                                                           :disabled="disable">
                                                    {{sendSmsButtonName}}
                                                </el-button>
                                            </template>
                                        </el-input>
                                        <div style="color: #ff4e4e;margin-left: -170px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_code}}</div>
                                    </div>
                                    <div v-show="active1 === 1" style="margin-top: 26px;">
<!--                                        输入新手机号-->
                                        <el-input
                                                :placeholde="telephone"
                                                v-model="telephone"
                                                style="width: 250px;">
                                        </el-input><br>
                                        <el-input v-model="code" placeholder="请输入验证码" @blur="verificationCode" style="width: 250px;margin-top: 10px;">
                                            <template #suffix>
                                                <el-button id="sendCodeId" type="text" class="sendSms_button--text" @click="sendSms"
                                                           :disabled="disable">
                                                    {{sendSmsButtonName}}
                                                </el-button>
                                            </template>
                                        </el-input>
                                        <div style="color: #ff4e4e;margin-left: -170px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_code}}</div>
                                    </div>
                                    <div v-show="active1 === 3">
                                        <el-result icon="success" title="更新成功"></el-result>
                                        <div style="margin-bottom: -20px;">
                                            <el-button type="primary" plain @click="next1" class="next_style--primary">完成</el-button>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: -20px;padding-top: 20px;" v-show="active1 < 2">
                                        <el-button type="primary" plain @click="next1" class="next_style--primary">下一步</el-button>
                                    </div>

                                </el-dialog>
                            </div>


                            <el-row>
                                <el-col :span="6" style="margin-top: -100px;margin-left: -1px;color: #333333;">
                                    <span style="font-size: 20px;"><i class="ri-mail-line"></i></span>
                                    <span>电子邮箱</span>
                                </el-col>
                                <el-col :span="6" style="margin-top: -100px;margin-left: -14px;height: 200px;">
                                    <div style="width: 210px;">
                                        <el-input
                                                :placeholder="email"
                                                v-model="email"
                                                :disabled="true">
                                        </el-input>
                                    </div>
                                </el-col>
                                <el-col :span="12" style="margin-top: -100px;">
                                    <div style="margin-left: 158px;">
                                        <span style="font-size: 18px;color: #949393;"><i class="ri-quill-pen-fill"></i></span>
                                        <el-button type="text" class="update_button--text" @click="updateEmail">修改
                                        </el-button>
                                    </div>
                                </el-col>
                            </el-row>

<!--                            更新电子邮件-->
                            <div>
                                <el-dialog
                                        :visible.sync="dialogUpdateEmail"
                                        width="30%"
                                        :before-close="handleClose"
                                        :show-close="false"
                                        class="dialog_style">
                                    <span>
                                        <el-steps :active="active2" finish-status="success" align-center style="line-height: 1;width: 400px;margin-top: -30px;">
                                            <el-step title="验证当前邮箱"></el-step>
                                            <el-step title="更改为新邮箱"></el-step>
                                            <el-step title="更改完成"></el-step>
                                        </el-steps>
                                    </span>
                                    <div v-show="active2===0" style="margin-top: 26px;">
                                        <!--                                        验证当前邮箱-->
                                        <el-input
                                                :placeholde="email"
                                                v-model="email"
                                                :disabled="true"
                                                style="width: 250px;">
                                        </el-input><br>
                                        <el-input v-model="code" placeholder="请输入验证码" @blur="verificationCode" style="width: 250px;margin-top: 10px;">
                                            <template #suffix>
                                                <el-button id="sendCodeId" type="text" class="sendSms_button--text" @click="sendSms"
                                                           :disabled="disable">
                                                    {{sendSmsButtonName}}
                                                </el-button>
                                            </template>
                                        </el-input>
                                        <div style="color: #ff4e4e;margin-left: -170px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_code}}</div>
                                    </div>
                                    <div v-show="active2 === 1" style="margin-top: 26px;">
                                        <!--                                        输入新邮箱-->
                                        <el-input
                                                :placeholde="email"
                                                v-model="email"
                                                style="width: 250px;">
                                        </el-input><br>
                                        <el-input v-model="code" placeholder="请输入验证码" @blur="verificationCode" style="width: 250px;margin-top: 10px;">
                                            <template #suffix>
                                                <el-button id="sendCodeId" type="text" class="sendSms_button--text" @click="sendSms"
                                                           :disabled="disable">
                                                    {{sendSmsButtonName}}
                                                </el-button>
                                            </template>
                                        </el-input>
                                        <div style="color: #ff4e4e;margin-left: -170px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_code}}</div>
                                    </div>
                                    <div v-show="active2 === 3">
                                        <el-result icon="success" title="更新成功"></el-result>
                                        <div style="margin-bottom: -20px;">
                                            <el-button type="primary" plain @click="next2" class="next_style--primary">完成</el-button>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: -20px;padding-top: 20px;" v-show="active2 < 2">
                                        <el-button type="primary" plain @click="next2" class="next_style--primary">下一步</el-button>
                                    </div>

                                </el-dialog>
                            </div>


                            <el-row>
                                <el-col :span="6" style="margin-top: -100px;margin-left: -14px;color: #333333;">
                                    <span style="font-size: 20px;"><i class="ri-key-fill"></i></span>
                                    <span>密码</span>
                                </el-col>
                                <el-col :span="6" style="margin-top: -100px;color: #333333;margin-left: -72px;">
                                    <span style="margin-right: -50px;">********</span>
                                </el-col>
                                <el-col :span="12" style="margin-top: -100px;">
                                    <div style="margin-left: 300px;">
                                        <span style="font-size: 18px;color: #949393;"><i class="ri-quill-pen-fill"></i></span>
                                        <el-button type="text" class="update_button--text" @click="updatePassword">
                                            修改
                                        </el-button>
                                    </div>
                                </el-col>
                            </el-row>

<!--                            更新密码-->
                            <div>
                                <el-dialog
                                        :visible.sync="dialogUpdatePassword"
                                        width="30%"
                                        :before-close="handleClose"
                                        :show-close="false"
                                        class="dialog_style">
                                    <span>
                                        <el-steps :active="active3" finish-status="success" align-center style="line-height: 1;width: 400px;margin-top: -30px;margin-left: -6px;">
                                            <el-step title="更改密码"></el-step>
                                            <el-step title="更改完成"></el-step>
                                        </el-steps>
                                    </span>
                                    <div v-show="active3 === 0" style="margin-top: 26px;">
                                        <!--                                        -->
                                        <el-input
                                                placeholder='请输入当前密码'
                                                v-model="oldPassword"
                                                style="width: 250px;"
                                                show-password>
                                        </el-input><br>
                                        <el-input
                                                placeholder="请输入新密码"
                                                v-model="newPassword1"
                                                style="width: 250px;"
                                                show-password>
                                        </el-input><br>
                                        <el-input
                                                placeholder="请重新输入新密码"
                                                v-model="newPassword2"
                                                style="width: 250px;"
                                                show-password>
                                        </el-input><br>

                                        <div style="color: #ff4e4e;float: left;margin-left: 70px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_password}}</div>
                                    </div>
                                    <div v-show="active3 === 2" style="margin-top: 26px;">
                                        <!--                                        -->
                                        <el-result icon="success" title="更新成功"></el-result>
                                        <div style="margin-bottom: -20px;">
                                            <el-button type="primary" plain @click="next3" class="next_style--primary">完成</el-button>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: -20px;padding-top: 20px;" v-show="active3 === 0">
                                        <el-button type="primary" plain @click="modifyPassword" class="next_style--primary">点击更改</el-button>
                                    </div>

                                </el-dialog>
                            </div>

<!--                        设置密码-->
                            <div>
                                <el-dialog
                                        :visible.sync="dialogSettingPassword"
                                        width="30%"
                                        :before-close="handleClose"
                                        :show-close="false"
                                        class="dialog_style">
                                    <span>
                                        <el-steps :active="active3" finish-status="success" align-center style="line-height: 1;width: 400px;margin-top: -30px;margin-left: -6px;">
                                            <el-step title="设置密码"></el-step>
                                            <el-step title="设置完成"></el-step>
                                        </el-steps>
                                    </span>
                                    <div v-show="active3 === 0" style="margin-top: 26px;">
                                        <!--                                        -->
                                        <el-input
                                                placeholder="请设置密码"
                                                v-model="newPassword1"
                                                style="width: 250px;"
                                                show-password>
                                        </el-input><br>
                                        <el-input
                                                placeholder="请重新输入密码"
                                                v-model="newPassword2"
                                                style="width: 250px;"
                                                show-password>
                                        </el-input><br>

                                        <div style="color: #ff4e4e;float: left;margin-left: 70px;height: 30px;margin-top: -20px; font-family: 'Noto Sans SC', sans-serif !important;">{{this.error_password}}</div>
                                    </div>
                                    <div v-show="active3 === 2" style="margin-top: 26px;">
                                        <!--                                        -->
                                        <el-result icon="success" title="设置成功"></el-result>
                                        <div style="margin-bottom: -20px;">
                                            <el-button type="primary" plain @click="next3" class="next_style--primary">完成</el-button>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: -20px;padding-top: 20px;" v-show="active3 === 0">
                                        <el-button type="primary" plain @click="settingPassword" class="next_style--primary">点击设置</el-button>
                                    </div>

                                </el-dialog>
                            </div>
                        </div>

                        <div style="background-color: #eceaea;height: 2px;margin-top: -20px;"></div>
                        <el-row>
                            <el-col style="margin-left: -440px;margin-top: -50px;">
                                <h3>关联第三方账号</h3>
                            </el-col>
                        </el-row>

                        <div>

                            <el-row>
                                <el-col style="margin-top: -100px;" :span="12">
                                    <span style="font-size: 34px;cursor:pointer;"><i class="ri-qq-line"
                                                                                     @click="bindQQ"></i></span>
                                    <span style="color: #9c0000;font-size: 30px;" v-show="!isBindQQ"><i
                                            class="ri-close-line"></i></span>
                                    <span style="color: #229c00;font-size: 30px;" v-show="isBindQQ"><i
                                            class="ri-check-line"></i></span>
                                </el-col>

                                <el-col style="margin-top: -100px;" :span="12">
                                    <span style="font-size: 34px;cursor:pointer;"><i class="ri-github-fill"
                                                                                     @click="bindGitHub"></i></span>
                                    <span style="color: #9c0000;font-size: 30px;" v-show="!isBindGitHub"><i
                                            class="ri-close-line"></i></span>
                                    <span style="color: #229c00;font-size: 30px;" v-show="isBindGitHub"><i
                                            class="ri-check-line"></i></span>
                                </el-col>
                            </el-row>

                        </div>

                    </el-card>

                </el-main>
            </el-container>
            <!--            右侧-->
            <el-aside width="300px" style="background-color: #f5f5f5">


                <!--                回到顶部-->
                <el-backtop :bottom="150" visibility-height="140" :right="180" style="width: 50px;">
                    <div style="{
                                height: 100%;
                                width: 100%;
                                background-color: #f2f5f6;
                                box-shadow: 0 0 6px rgb(16,178,160);
                                text-align: center;
                                line-height: 50px;
                                color: #10b2a0;
                                border-radius: 16px;
                                }">
                        <div style="font-size: 30px;">
                            <i class="ri-rocket-2-fill"></i>
                        </div>
                    </div>
                </el-backtop>

            </el-aside>
        </el-container>
        <!--        脚部-->
        <el-footer height="40px" style="background-color: #f5f5f5">
            <div style="margin-top: -32px">
                <h5>Copyright © 2023 Pipilong. 皮皮龙技术分享 版权所有 <a href="https://beian.miit.gov.cn/"
                                                                          target="_blank" class="footer-style">皖ICP备2023001037号-1</a>
                </h5>
            </div>
        </el-footer>

    </el-container>

</div>

<script>

    const service = axios.create({
        withCredentials: true, // 跨域请求时发送Cookie
        timeout: 60000, // 请求超时
    });

</script>

<script>

    new Vue({
        el: "#app",

        mounted() {

            service.get("https://www.pipilong.com.cn/verification/isLogin").then(res => {
                this.user_id = res.data;
                this.avatarUrl = "https://cos.pipilong.com.cn/UserAvatar/" + this.user_id +".jpg";
                this.imageUrl = this.avatarUrl;
                this.isLogin = true;
            }).catch(error => {
                window.open('./login.html', '_parent', 'location=yes,height=570,width=520,scrollbars=yes,status=yes');
            });

            service.get("https://www.pipilong.com.cn/user/getprofile").then(res=>{
                this.user=res.data;
                this.telephone = res.data.telephone;
                this.email = res.data.email;
            }).catch(error=>{
                this.$message.error('登录异常，请重新登录！');
            });

        },

        methods: {
            login() {
                this.dialogVisibleLogin = true;
            },
            tableRowClassName({row, rowIndex}) {
                if (rowIndex === 1) {
                    return 'warning-row';
                } else if (rowIndex === 3) {
                    return 'success-row';
                }
                return '';
            },
            add_tableData() {
                this.tableData.push("new data!");
                this.tableData.push("new data!");
                this.tableData.push("new data!");
                this.tableData.push("new data!");
                this.tableData.push("new data!");
                this.tableData.push("new data!");
                this.tableData.push("new data!");
            },
            avatarShow() {
                this.isAvatarShow = true;
            },
            avatarShut() {
                this.isAvatarShow = false;
            },
            openPersonalSettings() {
                window.location.href = './personal-settings.html';
            },
            logout() {

                service.get('https://www.pipilong.com.cn/logout').then(res=>{
                    window.location.href='./index.html';
                }).catch(error=>{
                    this.$message.error('退出登录失败！');
                });

            },
            handleAvatarSuccess(res, file) {
                this.imageUrl = URL.createObjectURL(file.raw);
            },
            beforeAvatarUpload(file) {
                this.file = file;
                const isJPG = file.type === 'image/jpeg';
                const isLt2M = file.size / 1024 / 1024 < 2;

                if (!isJPG) {
                    this.$message.error('上传头像图片只能是 JPG 格式!');
                }
                if (!isLt2M) {
                    this.$message.error('上传头像图片大小不能超过 2MB!');
                }
                return isJPG && isLt2M;
            },
            upload() {
                let formData = new FormData();
                formData.append("file", this.file);
                service.post('https://www.pipilong.com.cn/upload/avatar', formData, {headers: {'Content-Type': 'multipart/form-data'}}).then(res => {
                    this.avatarUrl = "https://cos.pipilong.com.cn/UserAvatar/" + this.user_id+".jpg";
                    this.imageUrl = this.avatarUrl;
                    this.$message({
                        message: '更改成功！',
                        type: 'success'
                    });
                }).catch(error => {

                });
            },
            save() {

                service.put('https://www.pipilong.com.cn/user/modifyprofile',this.user).then(res=>{
                    this.$message({
                        message: '保存成功',
                        type: 'success'
                    });
                }).catch(error=>{
                    this.$message.error(error.response.data);
                });

            },
            bindQQ() {
                this.isBindQQ = !this.isBindQQ;
            },
            bindGitHub() {

                //绑定github
                if(!this.isBindGitHub){
                    service.get('https://www.pipilong.com.cn/oauth2/authorization/github').then(res=>{
                        this.isBindGitHub=true;
                        this.$message({
                            message: '绑定成功！',
                            type: 'success'
                        });
                    }).catch(error=>{
                        this.isBindGitHub=false;
                        this.$message.error('绑定失败！');
                    });

                }else {
                    //解绑github


                }

            },
            updateTelephone() {
                this.active1=0;
                this.error_code='';
                this.code='';
                this.code_verification=false;
                this.dialogUpdateTelephone = true;
            },
            updateEmail() {
                this.active2=0;
                this.error_code='';
                this.code='';
                this.code_verification=false;
                this.dialogUpdateEmail = true;
            },
            updatePassword() {
                this.active3=0;
                this.error_password='';
                this.oldPassword='';
                this.newPassword2='';
                this.newPassword1='';
                service.get("https://www.pipilong.com.cn//password/"+this.user_id).then(res=>{
                    this.dialogUpdatePassword = true;
                }).catch(error=>{
                    this.dialogSettingPassword = true;
                });
            },
            next1() {
                if (this.active1 === 0 ) {
                    if(!this.code_verification) return;
                    this.code='';
                    this.code_verification=false;
                    this.count=0;
                    this.error_code='';
                    this.active1++;
                }else{
                    if(this.active1 === 1){
                        if(!this.code_verification) return;
                        this.code='';
                        this.code_verification=false;
                        this.modifyPhone();
                        this.error_code='';
                        this.active1+=2;
                    }else{
                        if(this.active1 === 3){
                            this.dialogUpdateTelephone = false;
                        }
                    }
                }
            },
            next2() {
                if (this.active2 === 0 ) {
                    if(!this.code_verification) return;
                    this.code='';
                    this.code_verification=false;
                    this.count=0;
                    this.error_code='';
                    this.active2++;
                }else{
                    if(this.active2 === 1){
                        if(!this.code_verification) return;
                        this.code='';
                        this.code_verification=false;
                        this.modifyEmail();
                        this.error_code='';
                        this.active2+=2;
                    }else{
                        if(this.active2 === 3){
                            this.dialogUpdateEmail = false;
                        }
                    }
                }
            },
            next3() {
                if(this.active3 === 2){
                    this.dialogUpdatePassword = false;
                }
            },
            sendSms() {
                this.error_code = '';
                if (this.isSendSms) return;
                this.isSendSms = true;
                let url = null;
                let data=null;
                if(this.dialogUpdateTelephone){
                    url="https://www.pipilong.com.cn/sendcode/"+this.telephone;
                }else{
                    url="https://www.pipilong.com.cn/sendemail"
                    data = new FormData();
                    data.append('userid',this.user_id);
                }
                service.post(url,data).then((res) => {
                    console.info("kaishi");
                    var timeout = setInterval(() => {
                        if (this.count < 1) {
                            this.disable = false;
                            this.sendSmsButtonName = "获取验证码";
                            this.count = 60;
                            this.isSendSms = false;
                            clearInterval(timeout);
                        } else {
                            this.disable = true;
                            this.sendSmsButtonName = this.count-- + "s后重发";
                        }
                    }, 1000);
                }).catch((error) => {
                    this.error_code = error.response.data;
                    this.isSendSms = false;
                });
            },
            verificationCode(){
                if(this.code === '') return;
                service.get('https://www.pipilong.com.cn/verification/code/'+this.code).then(res=>{
                    this.code_verification=true;
                }).catch(error=>{
                    this.code_verification=false;
                   this.error_code=error.response.data;
                });

            },
            modifyPhone(){

                let form = new FormData();
                form.append('telephone',this.telephone);
                form.append('userid',this.user_id);
                service.put('https://www.pipilong.com.cn/user/modifyphone',form).then(res=>{
                }).catch(error=>{
                    this.dialogUpdateTelephone=false;
                    this.active1=0;
                    this.$message.error('修改失败');
                });

            },
            modifyEmail(){

                let form = new FormData();
                form.append('email',this.email);
                form.append('userid',this.user_id);
                service.put('https://www.pipilong.com.cn/user/modifyemail',form).then(res=>{
                }).catch(error=>{
                    this.dialogUpdateEmail=false;
                    this.active2=0;
                    this.$message.error('修改失败');
                });
            },
            modifyPassword(){

                if(this.oldPassword === ''){
                    this.error_password = '请输入密码！';
                    return;
                }
                if(this.newPassword1 !== this.newPassword2){
                    this.error_password = '新密码两次不一致，请重新输入！';
                    return;
                }

                let from = new FormData();
                from.append('oldpassword',this.oldPassword);
                from.append('newpassword',this.newPassword1);
                from.append('userid',this.user_id);
                service.post('https://www.pipilong.com.cn/user/modifypassword',from).then(res=>{
                    this.error_password='';
                    this.active3=2;
                }).catch(error=>{
                   this.error_password=error.response.data;
                });

            },
            settingPassword(){
                if(this.newPassword1 === ''){
                    this.error_password = '请输入密码！';
                    return;
                }
                if(this.newPassword1 !== this.newPassword2){
                    this.error_password = '新密码两次不一致，请重新输入！';
                    return;
                }
                let data = new FormData();
                data.append('newPassword',this.newPassword1);
                data.append('userId',this.user_id);
                service.post("https://www.pipilong.com.cn/user/settingPassword",data).then(res=>{
                    this.active3=2;
                }).catch(error=>{
                    this.$message.error("设置失败！");
                    this.dialogSettingPassword=false;
                });
            }
        },

        data() {
            return {
                oldPassword: '',
                newPassword1: '',
                newPassword2: '',
                error_password: '',
                code_verification: false,
                code: '',
                error_code: '',
                isSendSms: false,
                sendSmsButtonName: '获取验证码',
                disable: false,
                count: 60,
                search: '',
                isLogin: true,
                imageUrl: '',
                avatarUrl: '',
                fit: 'fill',
                reference: false,
                dialogVisibleLogin: false,
                drawer: false,
                tableData: ["北京", "上海", "广州", "深圳"],
                hotList: ["北京", "上海", "广州", "深圳", "天津", "重庆", "杭州", "深圳", "厦门", "合肥"],
                isAvatarShow: false,
                user: {
                    'username': '',
                    'gender': '',
                    'birthday': '',
                    'address': '',
                    'person_message': '',
                    'github_url': '',
                    'school': ''
                },
                telephone: '',
                email: '',
                file: null,
                isBindQQ: true,
                isBindGitHub: false,
                dialogUpdateTelephone: false,
                dialogUpdateEmail: false,
                dialogUpdatePassword: false,
                dialogSettingPassword: false,
                active1: 0,
                active2: 0,
                active3: 0,
                address_options: [
                    {value: "河北", label: "河北"},
                    {value: "山西", label: "山西"},
                    {value: "辽宁", label: "辽宁"},
                    {value: "吉林", label: "吉林"},
                    {value: "黑龙江", label: "黑龙江"},
                    {value: "江苏", label: "江苏"},
                    {value: "浙江", label: "浙江"},
                    {value: "安徽", label: "安徽"},
                    {value: "福建", label: "福建"},
                    {value: "江西", label: "江西"},
                    {value: "山东", label: "山东"},
                    {value: "河南", label: "河南"},
                    {value: "湖北", label: "湖北"},
                    {value: "湖南", label: "湖南"},
                    {value: "广东", label: "广东"},
                    {value: "海南", label: "海南"},
                    {value: "四川", label: "四川"},
                    {value: "贵州", label: "贵州"},
                    {value: "云南", label: "云南"},
                    {value: "陕西", label: "陕西"},
                    {value: "甘肃", label: "甘肃"},
                    {value: "青海", label: "青海"},
                    {value: "台湾", label: "台湾"},
                    {value: "内蒙古", label: "内蒙古"},
                    {value: "广西", label: "广西"},
                    {value: "西藏", label: "西藏"},
                    {value: "宁夏", label: "宁夏"},
                    {value: "新疆", label: "新疆"},
                    {value: "北京", label: "北京"},
                    {value: "天津", label: "天津"},
                    {value: "上海", label: "上海"},
                    {value: "重庆", label: "重庆"},
                    {value: "香港", label: "香港"},
                    {value: "澳门", label: "澳门"}
                ],
            }
        }
    });
</script>

</body>
</html>